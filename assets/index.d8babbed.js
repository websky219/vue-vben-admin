var e=Object.assign;import{k as t,y as n,z as o,b as a,bH as l,a4 as s,s as r,a9 as i,bI as c,d as u,bJ as d,a$ as p,i as f,o as m,j as b,w as h,Q as g,S as v,n as y,m as S,bK as A,D as w,r as x,u as C,f as R,a1 as O,bL as F,aK as P,aa as k,ag as j,a5 as B,H as M,bM as I,bz as T,N as D,l as U,bN as L,bO as $,bx as _,bu as N,a0 as E,a7 as V,bP as z,bQ as G,X as H,h as W,bR as q,ab as Y,bG as X,I as J,bS as K,bT as Q,bU as Z,bV as ee,C as te,bW as ne,bX as oe,bY as ae,bn as le,b1 as se,F as re,a as ie,ai as ce,bo as ue,a3 as de,a2 as pe,_ as fe,aj as me,b0 as be,bZ as he,b_ as ge,bC as ve,t as ye,b$ as Se,c0 as Ae,ax as we,R as xe,a6 as Ce,b7 as Re}from"./index.50b828bd.js";import"./index.38c8e961.js";import"./index.fdcc7c21.js";import"./index.47fbc714.js";import"./index.925fe361.js";import"./index.eae08916.js";import"./index.61099513.js";import"./index.9284d4e4.js";import{u as Oe}from"./useAttrs.cfd03cd2.js";import"./index.8d91dadc.js";import"./index.f4c035d6.js";import{b as Fe}from"./uuid.467c825e.js";import"./index.d469528e.js";import{u as Pe,_ as ke,a as je,b as Be}from"./index.56b9f6b2.js";import"./index.a45b2b74.js";import{_ as Me}from"./index.443a48d5.js";import{c as Ie,B as Te,b as De}from"./index.ea618bdb.js";import"./index.643da10c.js";import{d as Ue}from"./download.bf43035d.js";import{u as Le}from"./domUtils.4d4b190d.js";var $e={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ne=function(e,a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_e(e,t,n[t])}))}return e}({},e,a.attrs);return t(o,n(l,{icon:$e}),null)};Ne.displayName="LoadingOutlined",Ne.inheritAttrs=!1;var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"};function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ze=function(e,a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){Ve(e,t,n[t])}))}return e}({},e,a.attrs);return t(o,n(l,{icon:Ee}),null)};ze.displayName="MoreOutlined",ze.inheritAttrs=!1;function Ge(e,t="value",n="change"){const o=i(),u=null==o?void 0:o.emit,d=a({value:e[t]}),p=l(d);s((()=>{d.value=e[t]}));return[r({get:()=>d.value,set(e){c(e,p.value)||(d.value=e,null==u||u(n,e))}}),e=>{d.value=e},p]}var He=u({name:"RadioButtonGroup",components:{RadioGroup:d.Group,RadioButton:d.Button},props:{value:{type:String},options:{type:Array,default:()=>[]}},setup(e){const t=Oe(),[n]=Ge(e);return{state:n,getOptions:r((()=>{const{options:t}=e;if(!t||0===(null==t?void 0:t.length))return[];return t.some((e=>p(e)))?t.map((e=>({label:e,value:e}))):t})),attrs:t}}});He.render=function(e,t,o,a,l,s){const r=f("RadioButton"),i=f("RadioGroup");return m(),b(i,n(e.attrs,{value:e.state,"onUpdate:value":t[1]||(t[1]=t=>e.state=t),"button-style":"solid"}),{default:h((()=>[(m(!0),b(g,null,v(e.getOptions,(e=>(m(),b(r,{key:`${e.value}`,value:e.value},{default:h((()=>[y(S(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},16,["value"])};var We=u({name:"ApiSelect",components:{Select:A,LoadingOutlined:Ne},props:{value:w.string,numberToString:w.bool,api:{type:Function,default:null},params:{type:Object,default:()=>{}},resultField:w.string.def(""),labelField:w.string.def("label"),valueField:w.string.def("value")},emits:["options-change","change"],setup(e,{emit:t}){const n=x([]),o=x(!1),a=Oe(),{t:l}=C(),[i]=Ge(e),c=r((()=>{const{labelField:t,valueField:o,numberToString:a}=e;return R(n).reduce(((e,n)=>{if(n){const l=n[o];e.push({label:n[t],value:a?`${l}`:l})}return e}),[])}));return s((()=>{!async function(){const a=e.api;if(!a||!O(a))return;try{o.value=!0;const l=await a(e.params);if(Array.isArray(l))return n.value=l,void t("options-change",R(n));e.resultField&&(n.value=F(l,e.resultField)||[]),t("options-change",R(n))}catch(l){}finally{o.value=!1}}()})),{state:i,attrs:a,getOptions:c,loading:o,t:l}}});We.render=function(e,o,a,l,s,r){const i=f("LoadingOutlined"),c=f("Select");return m(),b(c,n(e.attrs,{options:e.getOptions,value:e.state,"onUpdate:value":o[1]||(o[1]=t=>e.state=t)}),P({_:2},[v(Object.keys(e.$slots),(t=>({name:t,fn:h((n=>[k(e.$slots,t,n)]))}))),e.loading?{name:"suffixIcon",fn:h((()=>[t(i,{spin:""})]))}:void 0,e.loading?{name:"notFoundContent",fn:h((()=>[t("span",null,[t(i,{spin:"",class:"mr-1"}),y(" "+S(e.t("component.form.apiSelectNotFound")),1)])]))}:void 0]),1040,["options","value"])};const{t:qe}=C();var Ye,Xe;(Xe=Ye||(Ye={})).SUCCESS="success",Xe.ERROR="error",Xe.UPLOADING="uploading";const Je={helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:Infinity},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:{}},api:{type:Function,default:null,required:!0}},Ke=e(e({value:{type:Array,default:()=>[]}},Je),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),Qe={value:{type:Array,default:()=>[]}},Ze={columns:{type:[Array],default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null}};function et(e){return/\.(jpg|jpeg|png|gif)$/i.test(e)}const tt=Symbol("basic-table");function nt(e){B(tt,e)}function ot(){return j(tt)}const{table:at}=Ie,{pageSizeOptions:lt,defaultPageSize:st,fetchSetting:rt,defaultSortFn:it,defaultFilterFn:ct}=at,ut="key",dt=lt,pt=st,ft=rt,mt=it,bt=ct,ht="center",gt="INDEX",vt="ACTION";var yt=u({name:"TableAction",components:{Icon:M,PopConfirmButton:I,Divider:T,Dropdown:Me,MoreOutlined:ze},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:w.bool.def(!0),outside:w.bool},setup(t){const{prefixCls:n}=D("basic-table-action");let o={};t.outside||(o=ot());return{prefixCls:n,getActions:r((()=>(t.actions||[]).map((t=>{const{popConfirm:n}=t;return e(e(e({type:"link",size:"small"},t),n||{}),{onConfirm:null==n?void 0:n.confirm,onCancel:null==n?void 0:n.cancel,enable:!!n})})))),getDropList:r((()=>(t.dropDownActions||[]).map(((n,o)=>{const{label:a}=n;return e(e({},n),{text:a,divider:o<t.dropDownActions.length-1&&t.divider})})))),getAlign:r((()=>{var e,t;const n=((null==(e=null==o?void 0:o.getColumns)?void 0:e.call(o))||[]).find((e=>"ACTION"===e.flag));return null!=(t=null==n?void 0:n.align)?t:"left"}))}}});yt.render=function(e,n,o,a,l,s){const r=f("Icon"),i=f("PopConfirmButton"),c=f("Divider"),u=f("MoreOutlined"),d=f("a-button"),p=f("Dropdown");return m(),b("div",{class:[e.prefixCls,e.getAlign]},[(m(!0),b(g,null,v(e.getActions,((n,o)=>(m(),b(g,{key:`${o}-${n.label}`},[t(i,n,{default:h((()=>[n.icon?(m(),b(r,{key:0,icon:n.icon,class:"mr-1"},null,8,["icon"])):U("",!0),y(" "+S(n.label),1)])),_:2},1040),e.divider&&o<e.getActions.length-(e.dropDownActions?0:1)?(m(),b(c,{key:0,type:"vertical"})):U("",!0)],64)))),128)),e.dropDownActions?(m(),b(p,{key:0,trigger:["hover"],dropMenuList:e.getDropList},{default:h((()=>[k(e.$slots,"more"),e.$slots.more?U("",!0):(m(),b(d,{key:0,type:"link",size:"small"},{default:h((()=>[t(u,{class:"icon-more"})])),_:1}))])),_:3},8,["dropMenuList"])):U("",!0)],2)};var St=u({components:{Image:L},props:{fileUrl:w.string.def(""),fileName:w.string.def("")}});const At={class:"thumb"};St.render=function(e,t,n,o,a,l){const s=f("Image");return m(),b("span",At,[e.fileUrl?(m(),b(s,{key:0,src:e.fileUrl,width:104},null,8,["src"])):U("",!0)])};const{t:wt}=C();function xt(e){return{width:120,title:wt("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:n})=>{const o=[{label:wt("component.upload.del"),color:"error",onClick:e.bind(null,n)}];return t(yt,{actions:o,outside:!0},null)}}}function Ct({handleRemove:e,handleDownload:n}){return{width:160,title:wt("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:o})=>{const a=[{label:wt("component.upload.del"),color:"error",onClick:e.bind(null,o)},{label:wt("component.upload.download"),onClick:n.bind(null,o)}];return t(yt,{actions:a},null)}}}var Rt=u({name:"FileList",props:Ze,setup(e){const n=Pe();return E((()=>e.dataSource),(()=>{V((()=>{var e;null==(e=null==n?void 0:n.redoModalHeight)||e.call(n)}))})),()=>{const{columns:n,actionColumn:o,dataSource:a}=e,l=[...n,o];return t("table",{class:"file-table"},[t("colgroup",null,[l.map((e=>{const{width:n=0,dataIndex:o}=e;return t("col",{style:n?{width:`${n}px`,minWidth:`${n}px`}:{},key:o},null)}))]),t("thead",null,[t("tr",{class:"file-table-tr"},[l.map((e=>{const{title:n="",align:o="center",dataIndex:a}=e;return t("th",{class:["file-table-th",o],key:a},"function"==typeof(l=n)||"[object Object]"===Object.prototype.toString.call(l)&&!$(l)?n:{default:()=>[n]});var l}))])]),t("tbody",null,[a.map(((e={},n)=>t("tr",{class:"file-table-tr",key:`${n+e.name||""}`},[l.map((n=>{const{dataIndex:o="",customRender:a,align:l="center"}=n,s=a&&O(a);return t("td",{class:["file-table-td",l],key:o},[s?null==a?void 0:a({text:e[o],record:e}):e[o]])}))])))])])}}}),Ot=u({components:{BasicModal:ke,Upload:z,Alert:G,FileList:Rt},props:Je,setup(n,{emit:o}){const{t:l}=C(),s=x(!1),i=x([]),c=a({fileList:[]}),[u,{closeModal:d}]=je(),{accept:p,helpText:f,maxNumber:m,maxSize:b}=H(n),{getAccept:h,getStringAccept:g,getHelpText:v}=function({acceptRef:e,helpTextRef:t,maxNumberRef:n,maxSizeRef:o}){const a=r((()=>{const t=R(e);return t&&t.length>0?t:[]})),l=r((()=>R(a).map((e=>`.${e}`)).join(","))),s=r((()=>{const a=R(t);if(a)return a;const l=[],s=R(e);s.length>0&&l.push(qe("component.upload.accept",[s.join(",")]));const r=R(o);r&&l.push(qe("component.upload.maxSize",[r]));const i=R(n);return i&&Infinity!==i&&l.push(qe("component.upload.maxNumber",[i])),l.join("ï¼Œ")}));return{getAccept:a,getStringAccept:l,getHelpText:s}}({acceptRef:p,helpTextRef:f,maxNumberRef:m,maxSizeRef:b}),{createMessage:y}=W(),S=r((()=>i.value.length>0&&!i.value.every((e=>e.status===Ye.SUCCESS)))),A=r((()=>{const e=i.value.some((e=>e.status===Ye.SUCCESS));return{disabled:s.value||0===i.value.length||!e}})),w=r((()=>{const e=i.value.some((e=>e.status===Ye.ERROR));return s.value?l("component.upload.uploading"):l(e?"component.upload.reUploadFailed":"component.upload.startUpload")}));return{columns:[{dataIndex:"thumbUrl",title:wt("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:n}=e||{};return n&&t(St,{fileUrl:n},null)}},{dataIndex:"name",title:wt("component.upload.fileName"),align:"left",customRender:({text:e,record:n})=>{const{percent:o,status:a}=n||{};let l="normal";return a===Ye.ERROR?l="exception":a===Ye.UPLOADING?l="active":a===Ye.SUCCESS&&(l="success"),t("span",null,[t("p",{class:"ellipsis mb-1",title:e},(s=e,"function"==typeof s||"[object Object]"===Object.prototype.toString.call(s)&&!$(s)?e:{default:()=>[e]})),t(_,{percent:o,size:"small",status:l},null)]);var s}},{dataIndex:"size",title:wt("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:wt("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===Ye.SUCCESS?t(N,{color:"green"},{default:()=>wt("component.upload.uploadSuccess")}):e===Ye.ERROR?t(N,{color:"red"},{default:()=>wt("component.upload.uploadError")}):e===Ye.UPLOADING?t(N,{color:"blue"},{default:()=>wt("component.upload.uploading")}):e}],actionColumn:xt((function(e){const t=i.value.findIndex((t=>t.uuid===e.uuid));-1!==t&&i.value.splice(t,1)})),register:u,closeModal:d,getHelpText:v,getStringAccept:g,getOkButtonProps:A,beforeUpload:function(t){const{size:o,name:a}=t,{maxSize:s}=n,r=R(h);if(s&&t.size/1024/1024>=s)return y.error(l("component.upload.maxSizeMultiple",[s])),!1;if(r.length>0&&!function(e,t){const n=t.join("|");return new RegExp("\\.("+n+")$","i").test(e.name)}(t,r))return y.error(l("component.upload.acceptUpload",[r.join(",")])),!1;const c={uuid:Fe(),file:t,size:o,name:a,percent:0,type:a.split(".").pop()};return!function(e){return et(e.name)}(t)?i.value=[...R(i),c]:function(e){return new Promise(((t,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t({result:o.result,file:e}),o.onerror=e=>n(e)}))}(t).then((({result:t})=>{i.value=[...R(i),e({thumbUrl:t},c)]})),!1},fileListRef:i,state:c,isUploadingRef:s,handleStartUpload:async function(){const{maxNumber:t}=n;if(i.value.length>t)return y.warning(l("component.upload.maxNumber",[t]));try{s.value=!0;const t=i.value.filter((e=>e.status!==Ye.SUCCESS))||[],o=await Promise.all(t.map((t=>async function(t){var o;const{api:a}=n;if(!a||!O(a))return q("upload api must exist and be a function");try{t.status=Ye.UPLOADING;const{data:a}=await(null==(o=n.api)?void 0:o.call(n,e(e({},n.uploadParams||{}),{file:t.file}),(function(e){const n=e.loaded/e.total*100|0;t.percent=n})));return t.status=Ye.SUCCESS,t.responseData=a,{success:!0,error:null}}catch(l){return t.status=Ye.ERROR,{success:!1,error:l}}}(t))));s.value=!1;const a=o.filter((e=>!e.success));if(a.length>0)throw a}catch(o){throw s.value=!1,o}},handleOk:function(){const{maxNumber:e}=n;if(i.value.length>e)return y.warning(l("component.upload.maxNumber",[e]));if(s.value)return y.warning(l("component.upload.saveWarn"));const t=[];for(const n of i.value){const{status:e,responseData:o}=n;e===Ye.SUCCESS&&o&&t.push(o.url)}if(t.length<=0)return y.warning(l("component.upload.saveError"));i.value=[],d(),o("change",t)},handleCloseFunc:function(){return s.value?(y.warning(l("component.upload.uploadWait")),!1):(i.value=[],!0)},getIsSelectFile:S,getUploadBtnText:w,t:l}}});const Ft={class:"upload-modal-toolbar"};Ot.render=function(e,o,a,l,s,r){const i=f("a-button"),c=f("Alert"),u=f("Upload"),d=f("FileList"),p=f("BasicModal");return m(),b(p,n({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,wrapClassName:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:h((()=>[t(i,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:h((()=>[y(S(e.getUploadBtnText),1)])),_:1},8,["onClick","disabled","loading"])])),default:h((()=>[t("div",Ft,[t(c,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),t(u,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,class:"upload-modal-toolbar__btn"},{default:h((()=>[t(i,{type:"primary"},{default:h((()=>[y(S(e.t("component.upload.choose")),1)])),_:1})])),_:1},8,["accept","multiple","before-upload"])]),t(d,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])])),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])};var Pt=u({components:{BasicModal:ke,FileList:Rt},props:Qe,setup(e,{emit:n}){const[o,{closeModal:a}]=je(),{t:l}=C(),s=x([]);return E((()=>e.value),(e=>{s.value=[],e.forEach((e=>{s.value=[...R(s),{url:e,type:e.split(".").pop()||"",name:e.split("/").pop()||""}]}))}),{immediate:!0}),{t:l,register:o,closeModal:a,fileListRef:s,columns:[{dataIndex:"url",title:wt("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:n}=e||{};return et(n)&&t(St,{fileUrl:n},null)}},{dataIndex:"name",title:wt("component.upload.fileName"),align:"left"}],actionColumn:Ct({handleRemove:function(e){const t=s.value.findIndex((t=>t.url===e.url));-1!==t&&(s.value.splice(t,1),n("list-change",s.value.map((e=>e.url))))},handleDownload:function(e){const{url:t=""}=e;Ue({url:t})}})}}});Pt.render=function(e,o,a,l,s,r){const i=f("FileList"),c=f("BasicModal");return m(),b(c,n({width:"800px",title:e.t("component.upload.preview"),wrapClassName:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:h((()=>[t(i,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])])),_:1},16,["title","onRegister"])};var kt=u({name:"BasicUpload",components:{UploadModal:Ot,UploadPreviewModal:Pt,Icon:M,Tooltip:Y},props:Ke,setup(t,{emit:n,attrs:o}){const{t:a}=C(),[l,{openModal:s}]=Be(),[i,{openModal:c}]=Be(),u=x([]),d=r((()=>{const{emptyHidePreview:e}=t;return!e||(!e||u.value.length>0)})),p=r((()=>{const n=e(e({},o),t);return X(n,"onChange")}));return E((()=>t.value),((e=[])=>{u.value=e}),{immediate:!0}),{registerUploadModal:l,openUploadModal:s,handleChange:function(e){u.value=[...R(u),...e||[]],n("change",u.value)},handlePreviewChange:function(e){u.value=[...e||[]],n("change",u.value)},registerPreviewModal:i,openPreviewModal:c,fileListRef:u,showPreview:d,bindValue:p,t:a}}});kt.render=function(e,o,a,l,s,r){const i=f("a-button"),c=f("Icon"),u=f("Tooltip"),d=f("a-button-group"),p=f("UploadModal"),v=f("UploadPreviewModal");return m(),b("div",null,[t(d,null,{default:h((()=>[t(i,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:h((()=>[y(S(e.t("component.upload.upload")),1)])),_:1},8,["onClick"]),e.showPreview?(m(),b(u,{key:0,placement:"bottom"},{title:h((()=>[y(S(e.t("component.upload.uploaded"))+" ",1),e.fileListRef.length?(m(),b(g,{key:0},[y(S(e.fileListRef.length),1)],64)):U("",!0)])),default:h((()=>[t(i,{onClick:e.openPreviewModal},{default:h((()=>[t(c,{icon:"bi:eye"}),e.fileListRef.length&&e.showPreviewNumber?(m(),b(g,{key:0},[y(S(e.fileListRef.length),1)],64)):U("",!0)])),_:1},8,["onClick"])])),_:1})):U("",!0)])),_:1}),t(p,n(e.bindValue,{onRegister:e.registerUploadModal,onChange:e.handleChange}),null,16,["onRegister","onChange"]),t(v,{value:e.fileListRef,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange},null,8,["value","onRegister","onListChange"])])};const jt=new Map;jt.set("Input",J),jt.set("InputGroup",J.Group),jt.set("InputPassword",J.Password),jt.set("InputSearch",J.Search),jt.set("InputTextArea",J.TextArea),jt.set("InputNumber",K),jt.set("AutoComplete",Q),jt.set("Select",A),jt.set("ApiSelect",We),jt.set("TreeSelect",Z),jt.set("Switch",ee),jt.set("RadioButtonGroup",He),jt.set("RadioGroup",d.Group),jt.set("Checkbox",te),jt.set("CheckboxGroup",te.Group),jt.set("Cascader",ne),jt.set("DatePicker",oe),jt.set("MonthPicker",oe.MonthPicker),jt.set("RangePicker",oe.RangePicker),jt.set("WeekPicker",oe.WeekPicker),jt.set("TimePicker",ae),jt.set("Upload",kt);const{t:Bt}=C();function Mt(e){return e.includes("Input")||e.includes("Complete")?Bt("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?Bt("common.chooseText"):""}const It=["DatePicker","MonthPicker","RangePicker","WeekPicker","TimePicker"];function Tt(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!$(e)}var Dt=u({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>{}},formProps:{type:Object,default:{}},allDefaultValues:{type:Object,default:{}},formModel:{type:Object,default:{}},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(o,{slots:a}){const{t:l}=C(),{schema:s,formProps:i}=H(o),c=(u=s,d=i,r((()=>{const t=R(u),{labelCol:n={},wrapperCol:o={}}=t.itemProps||{},{labelWidth:a,disabledLabelWidth:l}=t,{labelWidth:s,labelCol:r,wrapperCol:i}=R(d);if(!s&&!a&&!r||l)return n.style={textAlign:"left"},{labelCol:n,wrapperCol:o};let c=a||s;const p=e(e({},r),n),f=e(e({},i),o);return c&&(c=le(c)?`${c}px`:c),{labelCol:e({style:{width:c}},p),wrapperCol:e({style:{width:`calc(100% - ${c})`}},f)}})));var u,d;const p=r((()=>{const{allDefaultValues:t,formModel:n,schema:a}=o,{mergeDynamicData:l}=o.formProps;return{field:a.field,model:n,values:e(e(e({},l),t),n),schema:a}})),f=r((()=>{var e;const{schema:t,tableAction:n,formModel:a,formActionType:l}=o,{componentProps:s={}}=t;return O(s)?null!=(e=s({schema:t,tableAction:n,formModel:a,formActionType:l}))?e:{}:s})),m=r((()=>{const{disabled:e}=o.formProps,{dynamicDisabled:t}=o.schema,{disabled:n=!1}=R(f);let a=!!e||n;return ce(t)&&(a=t),O(t)&&(a=t(R(p))),a}));function b(){const{rules:e=[],component:t,rulesMessageJoinLabel:n,label:a,dynamicRules:s,required:r}=o.schema;if(O(s))return s(R(p));let i=ue(e);i&&0!==i.length||!r||(i=[{required:r,type:"string"}]);const c=i.findIndex((e=>Reflect.has(e,"required")&&!Reflect.has(e,"validator"))),{rulesMessageJoinLabel:u}=o.formProps;if(-1!==c){const e=i[c];if(e.required&&t){Reflect.has(e,"type")||(e.type="string");const l=Reflect.has(o.schema,"rulesMessageJoinLabel")?n:u;e.message=e.message||Mt(t)+`${l?a:""}`,(t.includes("Input")||t.includes("Textarea"))&&(e.whitespace=!0),function(e,t){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(t)?e.type="object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(t)?e.type="array":["InputNumber"].includes(t)&&(e.type="number")}(e,t)}}const d=i.findIndex((e=>e.max));return-1===d||i[d].validator||(i[d].message=i[d].message||l("component.form.maxTip",[i[d].max])),i}function h(){const{label:e,helpMessage:a,helpComponentProps:l,subLabel:s}=o.schema,r=s?t("span",null,[e,y(" "),t("span",{style:"color:#00000073"},Tt(s)?s:{default:()=>[s]})]):e;return!a||Array.isArray(a)&&0===a.length?r:t("span",null,[r,t(Te,n({placement:"top",class:"mx-1",text:a},l),null)])}function v(){let l;const{itemProps:s,slot:r,render:i,field:u,suffix:d}=o.schema,{labelCol:v,wrapperCol:y}=R(c),{colon:S}=o.formProps,A=!!d,w=O(d)?d(R(p)):d;return t(re.Item,n({name:u,colon:S,class:{"suffix-item":A}},s,{label:h(),rules:b(),labelCol:v,wrapperCol:y}),Tt(l=t(g,null,[r?se(a,r,R(p)):i?i(R(p)):function(){var n;const{renderComponentContent:a,component:l,field:s,changeEvent:r="change",valueField:i}=o.schema,c=l&&["Switch","Checkbox"].includes(l),u=`on${Le(r)}`,d={[u]:e=>{v[u]&&v[u](e);const t=e?e.target:null,n=t?c?t.checked:t.value:e;o.setFormModel(s,n)}},b=jt.get(l),{autoSetPlaceHolder:h,size:g}=o.formProps,v=e(e({allowClear:!0,getPopupContainer:e=>e.parentNode,size:g},R(f)),{disabled:R(m)});let y;!v.disabled&&h&&"RangePicker"!==l&&l&&(y=(null==(n=R(f))?void 0:n.placeholder)||Mt(l)),v.placeholder=y,v.codeField=s,v.formValues=R(p);const S={[i||(c?"checked":"value")]:o.formModel[s]},A=e(e(e({},v),d),S);if(!a)return t(b,A,null);const w=O(a)?e({},a(R(p))):{default:()=>a};return t(b,A,Tt(w)?w:{default:()=>[w]})}(),A&&t("span",{class:"suffix"},Tt(w)?w:{default:()=>[w]})]))?l:{default:()=>[l]})}return()=>{let l;const{colProps:s={},colSlot:r,renderColContent:i,component:c}=o.schema;if(!jt.has(c))return null;const{baseColProps:u={}}=o.formProps,d=e(e({},u),s),{isIfShow:f,isShow:m}=function(){const{show:e,ifShow:t}=o.schema,{showAdvancedButton:n}=o.formProps,a=!n||!ce(o.schema.isAdvanced)||o.schema.isAdvanced;let l=!0,s=!0;return ce(e)&&(l=e),ce(t)&&(s=t),O(e)&&(l=e(R(p))),O(t)&&(s=t(R(p))),l=l&&a,{isShow:l,isIfShow:s}}();return f&&t(ie,n(d,{class:{hidden:!m}}),Tt(l=r?se(a,r,R(p)):i?i(R(p)):v())?l:{default:()=>[l]})}}});const Ut=Symbol();var Lt=u({name:"BasicFormAction",components:{FormItem:re.Item,Button:fe,BasicArrow:De,[ie.name]:ie},props:{showActionButtonGroup:w.bool.def(!0),showResetButton:w.bool.def(!0),showSubmitButton:w.bool.def(!0),showAdvancedButton:w.bool.def(!0),resetButtonOptions:{type:Object,default:{}},submitButtonOptions:{type:Object,default:{}},actionColOptions:{type:Object,default:{}},actionSpan:w.number.def(6),isAdvanced:w.bool,hideAdvanceBtn:w.bool},setup(t,{emit:n}){const{t:o}=C(),a=r((()=>{const{showAdvancedButton:n,actionSpan:o,actionColOptions:a}=t,l=24-o;return e(e({span:n?6:4},n?{span:l<6?24:l}:{}),a)})),l=r((()=>Object.assign({text:o("common.resetText")},t.resetButtonOptions))),s=r((()=>Object.assign({text:o("common.queryText")},t.submitButtonOptions)));return e({t:o,actionColOpt:a,getResetBtnOptions:l,getSubmitBtnOptions:s,toggleAdvanced:function(){n("toggle-advanced")}},de(Ut))}});function $t({transformDateFuncRef:e,fieldMapToTimeRef:t,defaultValueRef:n,getSchema:o,formModel:a}){const l=Pe();return{handleFormValues:function(n){if(!me(n))return{};const o={};for(const t of Object.entries(n)){let[,n]=t;const[a]=t;if(be(n)&&0===n.length||O(n))continue;const l=R(e);me(n)&&(n=l(n)),be(n)&&n[0]._isAMomentObject&&n[1]._isAMomentObject&&(n=n.map((e=>l(e)))),p(n)&&(n=n.trim()),o[a]=n}return function(e){const n=R(t);if(!n||!Array.isArray(n))return e;for(const[t,[o,a,l="YYYY-MM-DD"]]of n){if(!(t&&o&&a&&e[t]))continue;const[n,s]=e[t];e[o]=he(n).format(l),e[a]=he(s).format(l),Reflect.deleteProperty(e,t)}return e}(o)},initDefault:function(){const e=R(o),t={};e.forEach((e=>{const{defaultValue:n}=e;ge(n)||(t[e.field]=n,a[e.field]=n)})),n.value=t,V((()=>{var e;null==(e=null==l?void 0:l.redoModalHeight)||e.call(l)}))}}}Lt.render=function(e,o,a,l,s,r){const i=f("Button"),c=f("BasicArrow"),u=f("FormItem"),d=f("a-col");return e.showActionButtonGroup?(m(),b(d,n({key:0},e.actionColOpt,{style:{textAlign:"right"}}),{default:h((()=>[t(u,null,{default:h((()=>[k(e.$slots,"resetBefore"),e.showResetButton?(m(),b(i,n({key:0,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:h((()=>[y(S(e.getResetBtnOptions.text),1)])),_:1},16,["onClick"])):U("",!0),k(e.$slots,"submitBefore"),e.showSubmitButton?(m(),b(i,n({key:1,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:h((()=>[y(S(e.getSubmitBtnOptions.text),1)])),_:1},16,["onClick"])):U("",!0),k(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(m(),b(i,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:h((()=>[y(S(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),t(c,{class:"ml-1",expand:!e.isAdvanced,top:""},null,8,["expand"])])),_:1},8,["onClick"])):U("",!0),k(e.$slots,"advanceAfter")])),_:3})])),_:1},16)):U("",!0)};function _t({advanceState:t,emit:n,getProps:o,getSchema:a,formModel:l,defaultValueRef:s}){const{realWidthRef:i,screenEnum:c,screenRef:u}=ve(),d=r((()=>{if(!t.isAdvanced)return 0;const e=R(o).emptySpan||0;if(le(e))return e;if(me(e)){const{span:t=0}=e;return e[R(u).toLowerCase()]||t||0}return 0}));function p(e,n=0,a=!1){const l=R(i),s=parseInt(e.md)||parseInt(e.xs)||parseInt(e.sm)||e.span||24,r=parseInt(e.lg)||s,u=parseInt(e.xl)||r,d=parseInt(e.xxl)||u;return l<=c.LG?n+=s:l<c.XL?n+=r:l<c.XXL?n+=u:n+=d,a?(t.hideAdvanceBtn=!1,n<=48?(t.hideAdvanceBtn=!0,t.isAdvanced=!0):n>48&&n<=24*(R(o).autoAdvancedLine||3)?t.hideAdvanceBtn=!1:t.isLoad||(t.isLoad=!0,t.isAdvanced=!t.isAdvanced),{isAdvanced:t.isAdvanced,itemColSum:n}):n>24?{isAdvanced:t.isAdvanced,itemColSum:n}:{isAdvanced:!0,itemColSum:n}}return E([()=>R(a),()=>t.isAdvanced,()=>R(i)],(()=>{const{showAdvancedButton:r}=R(o);r&&function(){let r=0,i=0;const{baseColProps:c={}}=R(o);for(const t of R(a)){const{show:n,colProps:o}=t;let a=!0;if(ce(n)&&(a=n),O(n)&&(a=n({schema:t,model:l,field:t.field,values:e(e({},R(s)),l)})),a&&(o||c)){const{itemColSum:n,isAdvanced:a}=p(e(e({},c),o),r);r=n||0,a&&(i=r),t.isAdvanced=a}}t.actionSpan=i%24+R(d),p(R(o).actionColOptions||{span:24},r,!0),n("advanced-change")}()}),{immediate:!0}),{handleToggleAdvanced:function(){t.isAdvanced=!t.isAdvanced}}}function Nt({emit:e,getProps:t,formModel:n,getSchema:o,defaultValueRef:a,formElRef:l,schemaRef:s,handleFormValues:r}){function i(e,t){if(p(e)){const n=t.findIndex((t=>t.field===e));-1!==n&&t.splice(n,1)}}async function c(e){var t;return null==(t=R(l))?void 0:t.validateFields(e)}async function u(e){var t;return await(null==(t=R(l))?void 0:t.validate(e))}async function d(e){var t;await(null==(t=R(l))?void 0:t.clearValidate(e))}async function f(n){n&&n.preventDefault();const{submitFunc:o}=R(t);if(o&&O(o))return void(await o());if(R(l))try{const t=await u(),n=r(t);e("submit",n)}catch(a){}}return{handleSubmit:f,clearValidate:d,validate:u,validateFields:c,getFieldsValue:function(){return R(l)?r(ye(R(n))):{}},updateSchema:async function(e){let t=[];if(me(e)&&t.push(e),be(e)&&(t=[...e]),!t.every((e=>Reflect.has(e,"field")&&e.field)))return void Se("All children of the form Schema array that need to be updated must contain the `field` field");const n=[];t.forEach((e=>{R(o).forEach((t=>{if(t.field===e.field){const o=Ae(t,e);n.push(o)}else n.push(t)}))})),s.value=we(n,"field")},appendSchemaByField:async function(e,t,n=!1){const a=ue(R(o)),l=a.findIndex((e=>e.field===t));if(a.some((n=>n.field===t||e.field))){if(!t||-1===l||n)return n?a.unshift(e):a.push(e),void(s.value=a);-1!==l&&a.splice(l+1,0,e),s.value=a}},removeSchemaByFiled:async function(e){const t=ue(R(o));if(!e)return;let n=p(e)?[e]:e;p(e)&&(n=[e]);for(const o of n)i(o,t);s.value=t},resetFields:async function(){const{resetFunc:o,submitOnReset:s}=R(t);o&&O(o)&&await o(),R(l)&&(Object.keys(n).forEach((e=>{n[e]=a.value[e]})),d(),e("reset",ye(n)),s&&f())},setFieldsValue:async function(e){const t=R(o).map((e=>e.field)).filter(Boolean),a=[];Object.keys(e).forEach((l=>{const s=R(o).find((e=>e.field===l));let r=e[l];var i,c;if(i=null==s?void 0:s.component,c=r,r=i&&["Input","InputPassword","InputSearch","InputTextArea"].includes(i)&&c&&le(c)?`${c}`:c,null!=r&&t.includes(l)){if(function(e){return R(o).some((t=>t.field===e&&It.includes(t.component)))}(l))if(Array.isArray(r)){const e=[];for(const t of r)e.push(he(t));n[l]=e}else n[l]=he(r);else n[l]=r;a.push(l)}})),c(a)},scrollToField:async function(e,t){var n;await(null==(n=R(l))?void 0:n.scrollToField(e,t))}}}const Et={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},compact:w.bool,schemas:{type:[Array],default:()=>[],required:!0},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:w.bool.def(!0),submitOnReset:w.bool,size:w.oneOf(["default","small","large"]).def("default"),disabled:w.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:w.bool,transformDateFunc:{type:Function,default:e=>e._isAMomentObject?null==e?void 0:e.format("YYYY-MM-DD HH:mm:ss"):e},rulesMessageJoinLabel:w.bool.def(!0),autoAdvancedLine:w.number.def(3),showActionButtonGroup:w.bool.def(!0),actionColOptions:Object,showResetButton:w.bool.def(!0),autoFocusFirstItem:w.bool,resetButtonOptions:Object,showSubmitButton:w.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:w.bool,labelCol:Object,layout:w.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:Object,colon:w.bool,labelAlign:w.string};var Vt=u({name:"BasicForm",components:{FormItem:Dt,Form:re,Row:xe,FormAction:Lt},props:Et,emits:["advanced-change","reset","submit","register"],setup(t,{emit:n}){const o=a({}),l=a({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),i=x({}),c=x(!1),u=x({}),d=x(null),p=x(null),{prefixCls:f}=D("basic-form"),m=r((()=>e(e({},t),R(u)))),b=r((()=>[f,{[`${f}--compact`]:R(m).compact}])),h=r((()=>{const{baseRowStyle:e={}}=R(m);return e})),g=r((()=>{const e=R(d)||R(m).schemas;for(const t of e){const{defaultValue:e,component:n}=t;if(e&&It.includes(n))if(Array.isArray(e)){const n=[];e.forEach((e=>{n.push(he(e))})),t.defaultValue=n}else t.defaultValue=he(e)}return e})),{handleToggleAdvanced:v}=_t({advanceState:l,emit:n,getProps:m,getSchema:g,formModel:o,defaultValueRef:i}),{transformDateFunc:y,fieldMapToTime:S,autoFocusFirstItem:A}=H(t),{handleFormValues:w,initDefault:C}=$t({transformDateFuncRef:y,fieldMapToTimeRef:S,defaultValueRef:i,getSchema:g,formModel:o});!async function({getSchema:e,autoFocusFirstItem:t,formElRef:n,isInitedDefault:o}){s((async()=>{if(R(o)||!R(t))return;await V();const a=R(e),l=R(n),s=null==l?void 0:l.$el;if(!l||!s||!a||0===a.length)return;if(!a[0].component.includes("Input"))return;const r=s.querySelector(".ant-row:first-child input");r&&(null==r||r.focus())}))}({getSchema:g,autoFocusFirstItem:A,isInitedDefault:c,formElRef:p});const{handleSubmit:O,setFieldsValue:F,clearValidate:P,validate:k,validateFields:j,getFieldsValue:B,updateSchema:M,appendSchemaByField:I,removeSchemaByFiled:T,resetFields:U,scrollToField:L}=Nt({emit:n,getProps:m,formModel:o,getSchema:g,defaultValueRef:i,formElRef:p,schemaRef:d,handleFormValues:w});pe({resetAction:U,submitAction:O},Ut),E((()=>R(m).model),(()=>{const{model:e}=R(m);e&&F(e)}),{immediate:!0});const $=E((()=>g.value),(e=>{if(R(c))return $();(null==e?void 0:e.length)&&(C(),c.value=!0)}));const _={getFieldsValue:B,setFieldsValue:F,resetFields:U,updateSchema:M,setProps:async function(e){u.value=Ae(R(u)||{},e)},removeSchemaByFiled:T,appendSchemaByField:I,clearValidate:P,validateFields:j,validate:k,submit:O,scrollToField:L};return Ce((()=>{C(),n("register",_)})),e({handleToggleAdvanced:v,formModel:o,defaultValueRef:i,advanceState:l,getRowWrapStyle:h,getProps:m,formElRef:p,getSchema:g,formActionType:_,setFormModel:function(e,t){o[e]=t},prefixCls:f,getFormClass:b},_)}});Vt.render=function(o,a,l,s,r,i){const c=f("FormItem"),u=f("FormAction"),d=f("Row"),p=f("Form");return m(),b(p,n(e(e({},o.$attrs),o.$props),{class:o.getFormClass,ref:"formElRef",model:o.formModel}),{default:h((()=>[t(d,{style:o.getRowWrapStyle},{default:h((()=>[k(o.$slots,"formHeader"),(m(!0),b(g,null,v(o.getSchema,(e=>(m(),b(c,{key:e.field,tableAction:o.tableAction,formActionType:o.formActionType,schema:e,formProps:o.getProps,allDefaultValues:o.defaultValueRef,formModel:o.formModel,setFormModel:o.setFormModel},P({_:2},[v(Object.keys(o.$slots),(e=>({name:e,fn:h((t=>[k(o.$slots,e,t)]))})))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel"])))),128)),t(u,n(e(e({},o.getProps),o.advanceState),{onToggleAdvanced:o.handleToggleAdvanced}),P({_:2},[v(["resetBefore","submitBefore","advanceBefore","advanceAfter"],(e=>({name:e,fn:h((t=>[k(o.$slots,e,t)]))})))]),1040,["onToggleAdvanced"]),k(o.$slots,"formFooter")])),_:3},8,["style"])])),_:1},16,["class","model"])},Re(Vt);export{vt as A,ht as D,ft as F,gt as I,pt as P,ut as R,Vt as _,dt as a,We as b,mt as c,bt as d,nt as e,yt as f,kt as g,ot as u};